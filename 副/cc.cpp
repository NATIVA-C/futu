PRICE1:=IF((HIGH>CLOSE AND CLOSE>OPEN) OR (HIGH>OPEN AND OPEN>=CLOSE),CLOSE,HIGH);
PRICE2:=IF((LOW<CLOSE AND CLOSE<OPEN) OR (LOW<OPEN AND OPEN<=CLOSE),CLOSE,LOW);

TYP:= PRICE1 + PRICE2/3;
CCI:=(TYP-MA(TYP,36))/(0.015*AVEDEV(TYP,36));
CCI1:EMA(CCI,4),COLORGRAY;

STICKLINE(CCI1>98,CCI1,98,1,0),COLORMAGENTA;
STICKLINE(CCI1<-148,CCI1,-148,1,0),COLORYELLOW;

97,COLORRED;
-147,COLORGREEN;

IF(CROSS(CCI1,-150),60,-100),COLORBLUE;
DRAWICON(CROSS(100,CCI1),100,2);