{BULL}
CXH1:=7;
CXH2:=5;
CXH3:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*100;
CXH4:=SMA(CXH3,CXH1,1);
CXH5:=SMA(CXH4,CXH2,1);
CXH6:=(2*CLOSE+HIGH+LOW+OPEN)/5;
CXH7:=LLV(LOW,34);
CXH8:=HHV(HIGH,34);
CXH9:=EMA((CXH6-CXH7)/(CXH8-CXH7)*100,13);
CXH10:=EMA(CXH9,3);
BULLSELL:=CXH4<CXH5 AND CXH9<CXH10;
BULLBUY:=CXH4>CXH5 AND CXH9>CXH10;
BULLSELL2:=CXH4<CXH5 AND CXH9>CXH10;{短升長跌}
BULLBUY2:=CXH4>CXH5 AND CXH9<CXH10;{長升短跌}
DRAWTEXT(CXH4<CXH5 AND CXH9<CXH10,-3,'●'),COLORRED,LINETHICK9;
DRAWTEXT(CXH4>CXH5 AND CXH9>CXH10,-3,'●'),COLORGREEN,LINETHICK9;
DRAWTEXT(CXH4<CXH5 AND CXH9>CXH10,-3,'●'),COLORLIRED,LINETHICK9;
DRAWTEXT(CXH4>CXH5 AND CXH9<CXH10,-3,'●'),COLORLIGREEN,LINETHICK9;
DRAWTEXT(ISLASTBAR=1,-2.5,'BULL'),COLORWHITE

{BUY SET}
SETEB:=DIF<DEA AND J<D 
BUY1:=NOT(PERIOD=0) AND CROSS(TSI,SIG)AND NOT(SETEB) AND NOT(CXH4<CXH5 AND CXH9<CXH10) AND (持股 OR 買入)  AND C>UPPERK AND BBMC>REF(BBMC,1) AND TSI<30 AND ABS(C-O)<30;
BUY2:=TSI>SIG AND NOT(SETEB) AND NOT(CXH4<CXH5 AND CXH9<CXH10)   AND (持股 OR 買入)  AND C>UPPERK AND BBMC>REF(BBMC,1) AND TSI<30;
DRAWICON(BUY1,L*0.9998,1),COLORFFFF00,LINETHICK9
DRAWTEXT(BUY2,L,'●'),COLORFFFF00,LINETHICK1;


{SELL SET}
SELL1:=NOT(PERIOD=0) AND CROSS(SIG,TSI) AND SETEB AND NOT(CXH4>CXH5 AND CXH9>CXH10) AND (空倉 OR 賣出) AND C<LOWERK AND BBMC<REF(BBMC,1) AND TSI>-30 AND ABS(C-O)<30
SELL2:=SIG>TSI AND SETEB AND NOT(CXH4>CXH5 AND CXH9>CXH10) AND (空倉 OR 賣出) AND C<LOWERK AND BBMC<REF(BBMC,1) AND TSI>-30
DRAWICON(SELL1,H*1.0001,2),COLORFFFF00,LINETHICK9
DRAWTEXT(SELL2,H,'●'),COLORWHITE,LINETHICK1;

