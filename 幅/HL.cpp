N1:=9;
N2:=5;
MTM:=C-REF(C,1);
VAR1:=REF((LOW+OPEN+CLOSE+HIGH)/4,1);
VAR2:=SMA(ABS(LOW-VAR1),13,1)/SMA(MAX(LOW-VAR1,0),10,1);
VAR3:=EMA(VAR2,10);
VAR4:=LLV(LOW,33);

VAR5:=EMA(IF(LOW <=VAR4,VAR3,0),3);
VAR21:=SMA(ABS(HIGH-VAR1),13,1)/SMA(MIN(HIGH-VAR1,0),10,1);
VAR31:=EMA(VAR21,10);
VAR41:=HHV(HIGH,33);
VAR51:=EMA(IF(HIGH >=VAR41,VAR31,0),3);

主力进场:IF(VAR5 > REF(VAR5,1),VAR5,0),COLORRED,NODRAW;
STICKLINE(VAR5 > REF(VAR5,1),0,VAR5,1,0),COLOR000055;
STICKLINE(VAR5 > REF(VAR5,1),0,VAR5,0.8,0),COLOR000077;
STICKLINE(VAR5 > REF(VAR5,1),0,VAR5,0.6,0),COLOR000099;
STICKLINE(VAR5 > REF(VAR5,1),0,VAR5,0.4,0),COLOR0000BB;
STICKLINE(VAR5 > REF(VAR5,1),0,VAR5,0.2,0),COLOR0000DD;
STICKLINE(VAR5 > REF(VAR5,1),0,VAR5,0.1,0),COLOR0000FF;

洗盘:IF(VAR5 < REF(VAR5,1),VAR5,0),COLOR000079,NODRAW;
STICKLINE(VAR5 < REF(VAR5,1),0,VAR5,1,0),COLOR000079;
STICKLINE(VAR5 < REF(VAR5,1),0,VAR5,0.8,0),COLOR000093;
STICKLINE(VAR5 < REF(VAR5,1),0,VAR5,0.6,0),COLOR0000C6;
STICKLINE(VAR5 < REF(VAR5,1),0,VAR5,0.4,0),COLOR4A4AFF;
STICKLINE(VAR5 < REF(VAR5,1),0,VAR5,0.2,0),COLOR7D7DFF;
STICKLINE(VAR5 < REF(VAR5,1),0,VAR5,0.1,0),COLORAAAAFF;

主力拉高:IF(VAR51 < REF(VAR51,1),VAR51,0),COLORYELLOW,NODRAW;
STICKLINE(VAR51 < REF(VAR51,1),0,VAR51,1,0),COLOR005555;
STICKLINE(VAR51 < REF(VAR51,1),0,VAR51,0.8,0),COLOR009999;
STICKLINE(VAR51 < REF(VAR51,1),0,VAR51,0.6,0),COLOR11BBBB;
STICKLINE(VAR51 < REF(VAR51,1),0,VAR51,0.4,0),COLOR33DDDD;
STICKLINE(VAR51 < REF(VAR51,1),0,VAR51,0.2,0),COLOR55FFFF;

出货:IF(VAR51 > REF(VAR51,1),VAR51,0),COLORCYAN,NODRAW;
STICKLINE(VAR51 > REF(VAR51,1),0,VAR51,1.0,0), COLORCYAN;
STICKLINE(VAR51 > REF(VAR51,1),0,VAR51,0.9,0),COLOR555555;
STICKLINE(VAR51 > REF(VAR51,1),0,VAR51,0.8,0),COLOR777777;
STICKLINE(VAR51 > REF(VAR51,1),0,VAR51,0.6,0),COLOR999999;
STICKLINE(VAR51 > REF(VAR51,1),0,VAR51,0.4,0),COLORBBBBBB;
STICKLINE(VAR51 > REF(VAR51,1),0,VAR51,0.2,0),COLORDDDDDD;
STICKLINE(VAR51 > REF(VAR51,1),0,VAR51,0.1,0),COLORFFFFFF;

MM:100*(HHV(HIGH,55)-CLOSE)/(HHV(HIGH,55)-LLV(LOW,55)), COLORYELLOW,LINETHICK2;
RSV:=(CLOSE-LLV(LOW,34))/(HHV(HIGH,34)-LLV(LOW,34))*100;
K:=SMA(RSV,3,1);
D:=SMA(K,3,1);
J:=3*K-2*D;

RETAIL:EMA(J,6), COLORRED,LINETHICK2;
COND_BUYMORE:=CROSS(RETAIL,MM);
DRAWICON(COND_BUYMORE,MM,16);

COND_BUYLESS:=CROSS(MM,RETAIL);
DRAWICON(COND_BUYLESS,MM,6)


